{"version":3,"file":"jq-paginator.min.js","sources":["../src/jq-paginator.js"],"sourcesContent":["/* eslint-env jquery */\n/* eslint-disable new-cap */\n\n'use strict'\n\nvar $ = jQuery\n\n$.jqPaginator = function (el, options) {\n  if (!(this instanceof $.jqPaginator)) {\n    return new $.jqPaginator(el, options)\n  }\n\n  var self = this\n\n  self.$container = $(el)\n\n  self.$container.data('jqPaginator', self)\n\n  self.init = function () {\n    if (options.first || options.prev || options.next || options.last || options.page) {\n      options = $.extend(\n        {},\n        {\n          first: '',\n          prev: '',\n          next: '',\n          last: '',\n          page: ''\n        },\n        options\n      )\n    }\n\n    self.options = $.extend({}, $.jqPaginator.defaultOptions, options)\n\n    self.verify()\n\n    self.extendJquery()\n\n    self.render()\n\n    self.fireEvent(this.options.currentPage, 'init')\n  }\n\n  self.verify = function () {\n    var opts = self.options\n\n    if (!self.isNumber(opts.totalPages)) {\n      throw new Error('[jqPaginator] type error: totalPages')\n    }\n\n    if (!self.isNumber(opts.totalCounts)) {\n      throw new Error('[jqPaginator] type error: totalCounts')\n    }\n\n    if (!self.isNumber(opts.pageSize)) {\n      throw new Error('[jqPaginator] type error: pageSize')\n    }\n\n    if (!self.isNumber(opts.currentPage)) {\n      throw new Error('[jqPaginator] type error: currentPage')\n    }\n\n    if (!self.isNumber(opts.visiblePages)) {\n      throw new Error('[jqPaginator] type error: visiblePages')\n    }\n\n    if (!opts.totalPages && !opts.totalCounts) {\n      throw new Error('[jqPaginator] totalCounts or totalPages is required')\n    }\n\n    if (!opts.totalPages && opts.totalCounts && !opts.pageSize) {\n      throw new Error('[jqPaginator] pageSize is required')\n    }\n\n    if (opts.totalCounts && opts.pageSize) {\n      opts.totalPages = Math.ceil(opts.totalCounts / opts.pageSize)\n    }\n\n    if (opts.currentPage < 1 || opts.currentPage > opts.totalPages) {\n      throw new Error('[jqPaginator] currentPage is incorrect')\n    }\n\n    if (opts.totalPages < 1) {\n      throw new Error('[jqPaginator] totalPages cannot be less currentPage')\n    }\n  }\n\n  self.extendJquery = function () {\n    $.fn.jqPaginatorHTML = function (s) {\n      return s\n        ? this.before(s).remove()\n        : $('<p>')\n          .append(this.eq(0).clone())\n          .html()\n    }\n  }\n\n  self.render = function () {\n    self.renderHtml()\n    self.setStatus()\n    self.bindEvents()\n  }\n\n  self.renderHtml = function () {\n    var html = []\n\n    var pages = self.getPages()\n    for (var i = 0, j = pages.length; i < j; i++) {\n      html.push(self.buildItem('page', pages[i]))\n    }\n\n    self.isEnable('prev') && html.unshift(self.buildItem('prev', self.options.currentPage - 1))\n    self.isEnable('first') && html.unshift(self.buildItem('first', 1))\n    self.isEnable('statistics') && html.unshift(self.buildItem('statistics'))\n    self.isEnable('next') && html.push(self.buildItem('next', self.options.currentPage + 1))\n    self.isEnable('last') && html.push(self.buildItem('last', self.options.totalPages))\n\n    if (self.options.wrapper) {\n      self.$container.html(\n        $(self.options.wrapper)\n          .html(html.join(''))\n          .jqPaginatorHTML()\n      )\n    } else {\n      self.$container.html(html.join(''))\n    }\n  }\n\n  self.buildItem = function (type, pageData) {\n    var html = self.options[type]\n      .replace(/{{page}}/g, pageData)\n      .replace(/{{totalPages}}/g, self.options.totalPages)\n      .replace(/{{totalCounts}}/g, self.options.totalCounts)\n\n    return $(html)\n      .attr({\n        'jp-role': type,\n        'jp-data': pageData\n      })\n      .jqPaginatorHTML()\n  }\n\n  self.setStatus = function () {\n    var options = self.options\n\n    if (!self.isEnable('first') || options.currentPage === 1) {\n      $('[jp-role=first]', self.$container).addClass(options.disableClass)\n    }\n    if (!self.isEnable('prev') || options.currentPage === 1) {\n      $('[jp-role=prev]', self.$container).addClass(options.disableClass)\n    }\n    if (!self.isEnable('next') || options.currentPage >= options.totalPages) {\n      $('[jp-role=next]', self.$container).addClass(options.disableClass)\n    }\n    if (!self.isEnable('last') || options.currentPage >= options.totalPages) {\n      $('[jp-role=last]', self.$container).addClass(options.disableClass)\n    }\n\n    $('[jp-role=page]', self.$container).removeClass(options.activeClass)\n    $('[jp-role=page][jp-data=' + options.currentPage + ']', self.$container).addClass(options.activeClass)\n  }\n\n  self.getPages = function () {\n    var pages = []\n\n    var visiblePages = self.options.visiblePages\n\n    var currentPage = self.options.currentPage\n\n    var totalPages = self.options.totalPages\n\n    if (visiblePages > totalPages) {\n      visiblePages = totalPages\n    }\n\n    var half = Math.floor(visiblePages / 2)\n    var start = currentPage - half + 1 - (visiblePages % 2)\n    var end = currentPage + half\n\n    if (start < 1) {\n      start = 1\n      end = visiblePages\n    }\n    if (end > totalPages) {\n      end = totalPages\n      start = 1 + totalPages - visiblePages\n    }\n\n    var itPage = start\n    while (itPage <= end) {\n      pages.push(itPage)\n      itPage++\n    }\n\n    return pages\n  }\n\n  self.isNumber = function (value) {\n    var type = typeof value\n    return type === 'number' || type === 'undefined'\n  }\n\n  self.isEnable = function (type) {\n    return self.options[type] && typeof self.options[type] === 'string'\n  }\n\n  self.switchPage = function (pageIndex) {\n    self.options.currentPage = pageIndex\n    self.render()\n  }\n\n  self.fireEvent = function (pageIndex, type) {\n    return typeof self.options.onPageChange !== 'function' || self.options.onPageChange(pageIndex, type) !== false\n  }\n\n  self.callMethod = function (method, options) {\n    switch (method) {\n      case 'option':\n        self.options = $.extend({}, self.options, options)\n        self.verify()\n        self.render()\n        break\n      case 'destroy':\n        self.$container.empty()\n        self.$container.removeData('jqPaginator')\n        break\n      default:\n        throw new Error('[jqPaginator] method \"' + method + '\" does not exist')\n    }\n\n    return self.$container\n  }\n\n  self.bindEvents = function () {\n    var opts = self.options\n\n    self.$container.off()\n    self.$container.on('click', '[jp-role]', function () {\n      var $el = $(this)\n      if ($el.hasClass(opts.disableClass) || $el.hasClass(opts.activeClass)) {\n        return\n      }\n\n      var pageIndex = +$el.attr('jp-data')\n      if (self.fireEvent(pageIndex, 'change')) {\n        self.switchPage(pageIndex)\n      }\n    })\n  }\n\n  self.init()\n\n  return self.$container\n}\n\n$.jqPaginator.defaultOptions = {\n  wrapper: '',\n  first: '<li class=\"first\"><a href=\"javascript:;\">First</a></li>',\n  prev: '<li class=\"prev\"><a href=\"javascript:;\">Previous</a></li>',\n  next: '<li class=\"next\"><a href=\"javascript:;\">Next</a></li>',\n  last: '<li class=\"last\"><a href=\"javascript:;\">Last</a></li>',\n  page: '<li class=\"page\"><a href=\"javascript:;\">{{page}}</a></li>',\n  totalPages: 0,\n  totalCounts: 0,\n  pageSize: 0,\n  currentPage: 1,\n  visiblePages: 7,\n  disableClass: 'disabled',\n  activeClass: 'active',\n  onPageChange: null\n}\n\n$.fn.jqPaginator = function () {\n  var self = this\n\n  var args = Array.prototype.slice.call(arguments)\n\n  if (typeof args[0] === 'string') {\n    var $instance = $(self).data('jqPaginator')\n    if (!$instance) {\n      throw new Error('[jqPaginator] the element is not instantiated')\n    } else {\n      return $instance.callMethod(args[0], args[1])\n    }\n  } else {\n    return new $.jqPaginator(this, args[0])\n  }\n}\n"],"names":["$","jQuery","jqPaginator","el","options","this","self","$container","data","init","first","prev","next","last","page","extend","defaultOptions","verify","extendJquery","render","fireEvent","currentPage","opts","isNumber","totalPages","Error","totalCounts","pageSize","visiblePages","Math","ceil","fn","jqPaginatorHTML","s","before","remove","append","eq","clone","html","renderHtml","setStatus","bindEvents","pages","getPages","i","j","length","push","buildItem","isEnable","unshift","wrapper","join","type","pageData","replace","attr","jp-role","jp-data","addClass","disableClass","removeClass","activeClass","half","floor","start","end","itPage","value","switchPage","pageIndex","onPageChange","callMethod","method","empty","removeData","off","on","$el","hasClass","args","Array","prototype","slice","call","arguments","$instance"],"mappings":"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"}